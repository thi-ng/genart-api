"use strict";(()=>{var Ke=Object.defineProperty;var G=(t,e)=>{for(var r in e)Ke(t,r,{get:e[r],enumerable:!0})};var ie={};G(ie,{clamp:()=>S,clamp01:()=>E,div:()=>K,easeInOut5:()=>ne,fit:()=>j,mix:()=>w,norm:()=>V,parseNum:()=>ae,round:()=>R,smoothstep:()=>qe,smoothstep01:()=>q});var ae=(t,e=0)=>{let r=t?parseFloat(t):Number.NaN;return isNaN(r)?e:r},w=(t,e,r)=>t+(e-t)*r,j=(t,e,r,a,n)=>a+(n-a)*V(t,e,r),S=(t,e,r)=>t<e?e:t>r?r:t,E=t=>t<0?0:t>1?1:t,R=(t,e)=>Math.round(K(t,e))*e,V=(t,e,r)=>K(t-e,r-e),K=(t,e)=>e!=0?t/e:0,qe=(t,e,r)=>q(E(K(r-t,e-t))),q=t=>t*t*(3-2*t),We=t=>{let e=2**(t-1);return r=>r<.5?e*r**t:1-(-2*r+2)**t/2},ne=We(5);var de={};G(de,{PARAM_DEFAULTS:()=>Ae,bigint:()=>rt,binary:()=>at,choice:()=>pe,color:()=>nt,date:()=>it,datetime:()=>st,image:()=>mt,numlist:()=>le,ramp:()=>ot,range:()=>pt,strlist:()=>lt,text:()=>dt,time:()=>ft,toggle:()=>ct,vector:()=>ut,weighted:()=>gt,xy:()=>Pt});var J={};G(J,{ensure:()=>T,equiv:()=>Te,equivArrayLike:()=>_e,formatValuePrec:()=>Ze,hashBytes:()=>Ie,hashString:()=>Qe,isBigInt:()=>se,isFunction:()=>He,isInRange:()=>y,isNumber:()=>u,isNumericArray:()=>I,isString:()=>l,isStringArray:()=>me,isTypedArray:()=>Y,parseBigInt:()=>Z,parseUUID:()=>Je,stringifyBigInt:()=>Ye,u16:()=>X,u24:()=>oe,u32:()=>Xe,u8:()=>H,valuePrec:()=>be});var T=(t,e)=>{if(!t)throw new Error(e);return t},se=t=>typeof t=="bigint",u=t=>typeof t=="number"&&!isNaN(t),l=t=>typeof t=="string",He=t=>typeof t=="function",I=t=>Y(t)||Array.isArray(t)&&t.every(u),me=t=>Array.isArray(t)&&t.every(l),Y=t=>!!t&&(t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Int8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Uint8ClampedArray),y=(t,e,r)=>t>=e&&t<=r,H=t=>(t&=255,(t<16?"0":"")+t.toString(16)),X=t=>H(t>>>8)+H(t),oe=t=>X(t>>>8)+H(t&255),Xe=t=>X(t>>>16)+X(t),Ye=(t,e=10)=>{let r={10:"",2:"0b",8:"0o",16:"0x"}[e];return t<0n?"-"+r+(-t).toString(e):r+t.toString(e)},Z=t=>/^-0[box]/.test(t)?-BigInt(t.substring(1)):BigInt(t),be=t=>{let e=t.toString(),r=e.indexOf(".");return r>0?e.length-r-1:0},Ze=t=>{let e=be(t);return r=>r.toFixed(e)},Te=(t,e)=>t===e?!0:t==null?e==null:e==null?t==null:l(t)||u(t)?t===e:t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t.length!=null&&e.length!=null?_e(t,e):t===e||t!==t&&e!==e,_e=(t,e)=>{if(t.length!==e.length)return!1;let r=t.length;for(;r-- >0&&Te(t[r],e[r]););return r<0},W=0xfffffffffn,L=Math.imul,Je=t=>{let e=BigInt("0x"+t.replace(/-/g,"").substring(0,32));return new Uint32Array([Number(e>>96n&W),Number(e>>64n&W),Number(e>>32n&W),Number(e&W)])},Ie=(t,e=0)=>{let r=s=>t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s],a=(s,f)=>s<<f|s>>>32-f,n=(s,f)=>{let P=f+1&3;o[f]=L(a(o[f]^L(a(L(r(s),d[f]),15+f),d[P]),19-(f<<1))+o[P],5)+c[f]},i=s=>{let f=s[0]+=s[1]+s[2]+s[3];return s[1]+=f,s[2]+=f,s[3]+=f,s},m=s=>(s^=s>>>16,s=L(s,2246822507),s^=s>>>13,s=L(s,3266489909),s^=s>>>16),p=t.length,c=new Uint32Array([1444728091,197830471,2530024501,850148119]),d=new Uint32Array([597399067,2869860233,951274213,2716044179]),o=d.map(s=>s^e),h=0;for(let s=p&-16;h<s;h+=16)n(h,0),n(h+4,1),n(h+8,2),n(h+12,3);c.fill(0);for(let s=p&15;s>0;s--){let f=s-1;if((s&3)===1){let P=s>>2;c[P]=a(L(c[P]^t[h+f],d[P]),15+P),o[P]^=L(c[P],d[P+1&3])}else c[f>>2]^=t[h+f]<<(f<<3)}return i(i(o.map(s=>s^p)).map(m))},Qe=(t,e)=>Ie(new TextEncoder().encode(t),e);var et=/^\d{4}-\d{2}-\d{2}$/,Q={validate:(t,e)=>e instanceof Date||u(e)||l(e)&&et.test(e),coerce:(t,e)=>u(e)?new Date(e):l(e)?new Date(Date.parse(e)):e};var tt=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?(Z|[-+]\d{2}:\d{2})$/,ee={validate:(t,e)=>e instanceof Date||u(e)||l(e)&&tt.test(e),coerce:(t,e)=>u(e)?new Date(e):l(e)?new Date(Date.parse(e)):e};var k={validate:(t,e)=>I(e)&&e.length===3&&y(e[0],0,23)&&y(e[1],0,59)&&y(e[2],0,59)||l(e)&&/^([01]\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),coerce:(t,e)=>l(e)?e.split(":").map(ae):e,randomize:(t,e)=>[e()*24|0,e()*60|0,e()*60|0]};var te={validate:(t,e)=>{let{min:r,max:a,size:n}=t;return I(e)&&e.length===n&&e.every((i,m)=>y(i,r[m],a[m]))},coerce:(t,e)=>{let{min:r,max:a,step:n}=t;return e.map((i,m)=>S(R(i,n[m]),r[m],a[m]))},randomize:(t,e)=>{let{min:r,max:a,size:n,step:i}=t;return new Array(n).fill(0).map((m,p)=>S(R(w(r[p],a[p],e()),i[p]),r[p],a[p]))}};var Ae={desc:"TODO description",edit:"protected",group:"main",order:0,randomize:!0,state:"void",update:"event",widget:"default"},g=(t,e,r=!0)=>(T(e.name,"missing param `name`"),{...Ae,type:t,randomize:r,...e}),we=(t,e)=>e!=null?T(t.validate(null,e),`invalid default value: ${e}`)&&t.coerce(null,e):e,Se=(t,e=10)=>{let r=0,a=t.maxLength||e;return t.minLength&&(r=t.minLength,t.maxLength||(a=Math.max(r,e))),T(r<=a,"invalid list length constraint"),[r,a]},rt=t=>g("bigint",{min:0n,max:0xffffffffffffffffn,...t}),at=t=>g("binary",{minLength:0,maxLength:1024,...t},!1),pe=t=>g("choice",t),nt=t=>g("color",t),it=t=>g("date",{...t,default:we(Q,t.default)},!1),st=t=>g("datetime",{...t,default:we(ee,t.default)},!1),mt=t=>g("img",{default:t.default||new(t.format==="gray"?Uint8Array:Uint32Array)(t.width*t.height),...t},!1),le=t=>{let[e,r]=Se(t,10);return g("numlist",{default:t.default||new Array(e).fill(0),minLength:e,maxLength:r,...t},!1)},ot=t=>g("ramp",{...t,stops:t.stops?t.stops.flat():[0,0,1,1],mode:t.mode||"linear",default:0},!1),pt=t=>g("range",{min:0,max:100,step:1,...t}),lt=t=>{let[e,r]=Se(t,10);return g("strlist",{default:t.default||new Array(e).fill(""),minLength:e,maxLength:r,...t},!1)},dt=t=>g("text",{minLength:0,maxLength:1024,multiline:!1,...t},!1),ft=t=>g("time",{...t,default:t.default!=null?T(k.validate(null,t.default),"")&&k.coerce(null,t.default):t.default}),ct=t=>g("toggle",t),ut=t=>{t.labels?T(t.labels.length>=t.size,`expected ${t.size} labels`):T(t.size<=4,"missing vector labels");let e=(a,n,i=0)=>Array.isArray(n)?(T(n.length===a,"wrong vector size"),n):new Array(a).fill(u(n)?n:i),r={min:e(t.size,t.min,0),max:e(t.size,t.max,1),step:e(t.size,t.step,.01)};return g("vector",{...t,...r,default:t.default?T(t.default.length==t.size,`wrong vector size, expected ${t.size} values`)&&te.coerce(r,t.default):t.default,labels:t.labels||["X","Y","Z","W"].slice(0,t.size)})},gt=t=>g("weighted",{...t,options:t.options.sort((e,r)=>r[0]-e[0]),total:t.options.reduce((e,r)=>e+r[0],0)}),Pt=t=>g("xy",t);var Re={validate:(t,e)=>{let{min:r,max:a}=t;if(l(e)){if(!/^-?([0-9]+|0x[0-9a-f]+|0b[01]+|0o[0-7]+)$/.test(e))return!1;e=Z(e)}else if(u(e)||se(e))e=BigInt(e);else return!1;return e>=r&&e<=a},coerce:(t,e)=>l(e)?Z(e):BigInt(e),randomize:(t,e)=>{let{min:r,max:a}=t;return BigInt(j(e(),0,1,Number(r),Number(a)))}};var Le={validate:(t,e)=>{let{minLength:r,maxLength:a}=t;return e instanceof Uint8Array&&e.length>=r&&e.length<=a}};var Me={validate:(t,e)=>!!t.options.find(r=>(l(r)?r:r[0])===e),randomize:(t,e)=>{let r=t.options,a=r[e()*r.length|0];return l(a)?a:a[0]}};var Ne={validate:(t,e)=>l(e)&&/^#?[0-9a-f]{6,8}$/i.test(e),coerce:(t,e)=>(e[0]!=="#"?"#"+e:e).substring(0,7),randomize:(t,e)=>"#"+oe(e()*16777216|0)};var ve={validate:(t,e)=>{let{width:r,height:a,format:n}=t;return Y(e)&&e.length==r*a&&(n==="gray"?e instanceof Uint8Array||e instanceof Uint8ClampedArray:e instanceof Uint32Array)}};var Be={validate:(t,e)=>{let{minLength:r,maxLength:a}=t;return I(e)&&y(e.length,r,a)}};var Fe={validate:(t,e)=>u(e),read:(t,e)=>{let{stops:r,mode:a}=t,n=r.length,i=n;for(;(i-=2)>=0&&!(e>=r[i]););n-=2;let m=r[i],p=r[i+1],c=r[i+2],d=r[i+3];return i<0?r[1]:i>=n?r[n+1]:{exp:()=>w(p,d,ne(V(e,m,c))),linear:()=>j(e,m,c,p,d),smooth:()=>w(p,d,q(V(e,m,c)))}[a||"linear"]()},params:{stops:le({name:"Ramp stops",desc:"Control points",minLength:4,maxLength:1/0,default:[]}),mode:pe({name:"Ramp mode",desc:"Interpolation method",options:["linear","smooth","exp"]})}};var ze={validate:(t,e)=>{let{min:r,max:a}=t;return u(e)&&y(e,r,a)},coerce:(t,e)=>{let r=t;return S(R(e??r.default,r.step||1),r.min,r.max)},randomize:(t,e)=>{let{min:r,max:a,step:n}=t;return S(R(w(r,a,e()),n||1),r,a)}};var Ce={validate:(t,e)=>{let{minLength:r,maxLength:a,match:n}=t;if(!(me(e)&&y(e.length,r,a)))return!1;if(n){let i=l(n)?new RegExp(n):n;return e.every(m=>i.test(m))}return!0}};var De={validate:(t,e)=>{if(!l(e))return!1;let{minLength:r,maxLength:a,match:n}=t;return n&&!(l(n)?new RegExp(n):n).test(e)?!1:y(e.length,r,a)}};var je={validate:(t,e)=>l(e)?/^(true|false|0|1)$/.test(e):e===1||e===0||typeof e=="boolean",coerce:(t,e)=>e==="true"||e==="1"?!0:e==="false"||e==="0"?!1:!!e,randomize:(t,e)=>e()<.5};var Ee={validate:(t,e)=>!!t.options.find(r=>r[1]===e),randomize:(t,e)=>{let{options:r,total:a,default:n}=t,i=e()*a;for(let m=0,p=r.length;m<p;m++)if(a-=r[m][0],a<=i)return r[m][1];return n}};var Ve={validate:(t,e)=>I(e)&&e.length==2,coerce:(t,e)=>[E(e[0]),E(e[1])],randomize:(t,e)=>[e(),e()]};var fe={};G(fe,{sfc32:()=>yt,xorshift128:()=>ht,xsadd:()=>xt});var yt=t=>{let e=new Uint32Array(4);return e.set(t),()=>{let r=(e[0]+e[1]>>>0)+e[3]>>>0;return e[3]=e[3]+1>>>0,e[0]=e[1]^e[1]>>>9,e[1]=e[2]+(e[2]<<3)>>>0,e[2]=(e[2]<<21|e[2]>>>11)+r>>>0,r/4294967296}},ht=t=>{let e=new Uint32Array(4);return e.set(t),()=>{let r=e[3],a;return r^=r<<11,r^=r>>>8,e[3]=e[2],e[2]=e[1],a=e[1]=e[0],e[0]=(r^a^a>>>19)>>>0}},xt=t=>{let e=new Uint32Array(4);e.set([t,0,0,0]);for(let r=0,a=1;a<8;r=a++){let n=(e[r&3]^e[r&3]>>>30)>>>0;n=35173*n+((27655*n&65535)<<16)>>>0,e[a&3]^=a+n>>>0}return()=>{let r=e[0];return r^=r<<15,r^=r>>>18,r^=e[3]<<11,e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=r,r+e[2]>>>0}};var ke=(t,e,r=[])=>({head:()=>t[r[0]],push(a){for(;r.length&&e(t[r[r.length-1]],a);)r.pop();r.push(t.length-1)},shift(){r[0]===0&&r.shift();for(let a=r.length;a-- >0;)r[a]--}}),Ue=({targetFPS:t=60,period:e=200,width:r=e,height:a=100,style:n="position:fixed;z-index:9999;top:0;right:0;",bg:i="#222",text:m="#fff",fps:p=["#0f0","#ff0","#f00","#306"],fill:c=!0}={})=>{let d,o,h=r/e,s=r>=120,f=performance.now(),P=0,M=0,ye=0,N=[],U,z,x=t,$=0,he=!0,Oe=()=>{let A=[M,P],_=M-ye;if(ye=M,_<=0)return A;let O=1e3/_,C=N.push(O);U.push(O),z.push(O),C>e&&(C--,$-=N.shift(),U.shift(),z.shift()),$+=O;let{clamp01:re,round:Ge}=$genart.math;x+=(z.head()*1.1-x)*.1;let D=o.createLinearGradient(0,0,0,d.height);D.addColorStop(re(1-t/x),p[0]),D.addColorStop(re(1-(t-1)/x),p[1]),D.addColorStop(re(1-t/2/x),p[2]),D.addColorStop(1,p[3]),o.fillStyle=i,o.fillRect(0,0,r,a),o[c?"fillStyle":"strokeStyle"]=D,o.setLineDash([]),o.beginPath(),o.moveTo(-1,a);for(let b=0;b<C;b++)o.lineTo(b*h,(1-N[b]/x)*a);c?(o.lineTo((C-1)*h,a),o.closePath(),o.fill()):o.stroke(),o.fillStyle=o.strokeStyle=m,o.setLineDash([1,1]),o.beginPath();for(let b=x>90?30:x>30?15:5,v=Ge(Math.min(t,x+b/2),b);v>0;v-=b){let B=(1-v/x)*a;o.moveTo(r-80,B),s?(o.lineTo(r-22,B),o.fillText(String(v),r-20,B+1)):o.lineTo(r,B)}return o.stroke(),C>=e&&[[`sma(${e}):`,$/e],["max:",z.head()],["min:",U.head()]].forEach(([b,v],B)=>{let xe=a-8-B*12;o.fillText(b,4,xe),o.fillText(v.toFixed(1)+" fps",64,xe)}),A};return{start(){N=[],U=ke(N,(A,_)=>A>=_),z=ke(N,(A,_)=>A<=_),x=t*1.2,$=0,d||(d=document.createElement("canvas"),d.width=r,d.height=a,d.id="#FPS",d.setAttribute("style",n),document.body.appendChild(d),o=d.getContext("2d"),o.font="12px sans-serif",o.textBaseline="middle",o.strokeStyle=m,o.setLineDash([1,1]))},next(A){requestAnimationFrame(_=>{he?(f=_,P=0,he=!1):P++,M=_-f,A(M,P),Oe()})},now(){return[M,P]}}};var $e=(t=250,e=60,r=0)=>{let a=r,n=1e3/e;return{start(){a=r-1},next(i){setTimeout(()=>{a++,i(a*n,a)},t)},now:()=>[a*n,a]}};var ce=(t=0,e=0)=>{let r=performance.now(),a=e,n=t,i=!0;return{start(){i=!0},next(m){requestAnimationFrame(p=>{i?(r=p,a=e,i=!1):a++,n=t+p-r,m(n,a)})},now:()=>[n,a]}};var{ensure:F,isFunction:bt}=J,ge=class{_opts={id:Math.floor(Math.random()*1e12).toString(36),allowExternalConfig:!1,notifyFrameUpdate:!1};_adapter;_time=ce();_prng;_update;_state="init";_traits;_params;_paramTypes={bigint:Re,binary:Le,choice:Me,color:Ne,date:Q,datetime:ee,image:ve,numlist:Be,ramp:Fe,range:ze,strlist:Ce,text:De,time:k,toggle:je,vector:te,weighted:Ee,xy:Ve};math=ie;params=de;prng=fe;utils=J;time={debug:Ue,offline:$e,raf:ce};constructor(){window.addEventListener("message",e=>{let r=e.data;if(!(!this.isRecipient(e)||r?.__self))switch(r.type){case"genart:get-info":this.notifyInfo();break;case"genart:randomize-param":this.randomizeParamValue(r.paramID,r.key);break;case"genart:resume":this.start(!0);break;case"genart:configure":{let a=r.opts;delete a.id,delete a.allowExternalConfig,this.configure(a);break}case"genart:set-param-value":this.setParamValue(r.paramID,r.value,r.key);break;case"genart:start":this.start();break;case"genart:stop":this.stop();break}})}get version(){return"0.21.0"}get id(){return this._opts.id}get mode(){return this._adapter?.mode||"play"}get screen(){return this._adapter?.screen||{width:window.innerWidth,height:window.innerHeight,dpr:window.devicePixelRatio}}get random(){return this._prng?this._prng:this._prng=F(this._adapter,"missing platform adapter").prng}get state(){return this._state}get paramSpecs(){return this._params}get adapter(){return this._adapter}get timeProvider(){return this._time}registerParamType(e,r){ue(e),this._paramTypes[e]&&console.warn("overriding impl for param type:",e),this._paramTypes[e]=r}paramType(e){return ue(e),this._paramTypes[e]}async setParams(e){try{this._adapter?.augmentParams&&(e=this._adapter.augmentParams(e)),this._params={};for(let r in e){Pe(r);let a={...e.PARAM_DEFAULTS,...e[r]},n=this.ensureParamImpl(a.type);if(a.default==null)if(n.randomize)a.default=n.randomize(a,this.random.rnd),a.state="random";else if(n.read)a.state="dynamic";else throw new Error(`missing default value for param: ${r}`);else{if(!n.validate(a,a.default))throw new Error(`invalid default value for param: ${r} (${a.default})`);a.state="default"}this._params[r]=a}return this._adapter&&(this._adapter.initParams&&await this._adapter.initParams(this._params),await this.updateParams()),this.notifySetParams(),this.getParamValue.bind(this)}catch(r){throw this.setState("error",r.message),r}}setTraits(e){this._traits=e,this.emit({type:"genart:traits",traits:e})}async setAdapter(e){this._adapter=e,this.notifyReady()}waitForAdapter(){return this.waitFor("_adapter")}setTimeProvider(e){this._time=e,this.notifyReady()}waitForTimeProvider(){return this.waitFor("_time")}setUpdate(e){this._update=e,this.notifyReady()}async updateParams(e="none"){if(this._adapter)for(let r in this._params){let a=this._params[r],n=await this._adapter.updateParam(r,a);if(!n)continue;let{value:i,update:m}=n;if(m)for(let p in m)this.setParamValue(r,m[p],p,"none");this.setParamValue(r,i,void 0,i!=null||m?e:"none")}}setParamValue(e,r,a,n="all"){let{spec:i,impl:m}=this.ensureParam(e);if(r!=null){let p=i;if(a){let{spec:c,impl:d}=this.ensureNestedParam(i,a);p=c,m=d}if(!m.validate(p,r)){this.paramError(e);return}i[a||"value"]=m.coerce?m.coerce(p,r):r,a||(i.state="custom")}this.emit({type:"genart:param-change",__self:!0,param:this.asNestedParam(i),paramID:e,key:a},n)}randomizeParamValue(e,r,a=Math.random,n="all"){let{spec:i,impl:{randomize:m}}=this.ensureParam(e),p=m&&i.randomize!==!1;if(r){let{spec:c,impl:d}=this.ensureNestedParam(i,r),o=d.randomize&&c.randomize!==!1;o&&this.setParamValue(e,d.randomize(c,a),r,o||!p?n:"none")}p&&this.setParamValue(e,m(i,a),void 0,n)}getParamValue(e,r){return this.paramValueGetter(e)(r)}paramValueGetter(e){let{spec:r,impl:{randomize:a,read:n}}=this.ensureParam(e);return(i=0)=>{if(bt(i)){if(a)return a(r,i);i=0}return n?n(r,i):r.value??r.default}}paramError(e){this.emit({type:"genart:param-error",paramID:e})}configure(e){Object.assign(this._opts,e),this.notifyInfo()}on(e,r){window.addEventListener("message",a=>{this.isRecipient(a)&&a.data?.type===e&&r(a.data)})}emit(e,r="all"){if(r==="none")return;e.apiID=this.id;let a=r==="all";(a||r==="self")&&window.postMessage(e,"*"),(a&&parent!==window||r==="parent")&&parent.postMessage(e,"*")}start(e=!1){let r=this._state;if(r=="play")return;if(r!=="ready"&&r!=="stop")throw new Error(`can't start in state: ${r}`);this.setState("play");let a={type:"genart:frame",__self:!0,apiID:this.id,time:0,frame:0},n=(i,m)=>{this._state=="play"&&(this._update.call(null,i,m)?this._time.next(n):this.stop(),this._opts.notifyFrameUpdate&&(a.time=i,a.frame=m,this.emit(a)))};e||this._time.start(),this._time.next(n),this.emit({type:`genart:${e?"resume":"start"}`,__self:!0})}stop(){this._state==="play"&&(this.setState("stop"),this.emit({type:"genart:stop",__self:!0}))}capture(e){this._adapter?.capture(e),this.emit({type:"genart:capture",__self:!0},"parent")}setState(e,r){this._state=e,this.emit({type:"genart:state-change",__self:!0,state:e,info:r})}ensureParam(e){Pe(e);let r=F(F(this._params,"no params defined")[e],`unknown param: ${e}`);return{spec:r,impl:this.ensureParamImpl(r.type)}}ensureParamImpl(e){return ue(e),F(this._paramTypes[e],`unknown param type: ${e}`)}ensureNestedParam(e,r){let a=F(this.ensureParamImpl(e.type).params?.[r],`param type '${e.type}' has no nested: ${r}`);return{spec:a,impl:this.ensureParamImpl(a.type)}}waitFor(e){return this[e]?Promise.resolve():new Promise(r=>{let a=()=>{this[e]?r():setTimeout(a,0)};a()})}notifySetParams(){this._params&&Object.keys(this._params).length&&this.emit({type:"genart:params",__self:!0,params:this.asNestedParams({},this._params)})}notifyReady(){this._state==="init"&&this._adapter&&this._time&&this._update&&this.setState("ready")}notifyInfo(){let[e,r]=this._time.now();this.emit({type:"genart:info",opts:this._opts,state:this._state,version:this.version,adapter:this._adapter?.id,seed:this.random.seed,time:e,frame:r})}isRecipient({data:e}){return e!=null&&typeof e=="object"&&(e.apiID===this.id||e.apiID==="*")}asNestedParams(e,r){for(let a in r)e[a]=this.asNestedParam(r[a]);return e}asNestedParam(e){let r={...e},a=this._paramTypes[e.type];return a.params&&(r.__params=this.asNestedParams({},a.params)),r}},Pe=(t,e="ID")=>F(!(t==="__proto__"||t==="prototype"||t==="constructor"),`illegal param ${e}: ${t}`),ue=t=>Pe(t,"type");globalThis.$genart=new ge;})();
